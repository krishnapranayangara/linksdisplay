============================= test session starts ==============================
platform darwin -- Python 3.12.7, pytest-7.4.2, pluggy-1.0.0
rootdir: /Users/krishnapranayangara/Downloads/LinkDisplay/backend
configfile: pytest.ini
plugins: cov-4.1.0, anyio-4.2.0, flask-1.2.0
collected 74 items

tests/test_api.py ...............................F....F                  [ 50%]
tests/test_error_logging.py ...F....FF.........                          [ 75%]
tests/test_models.py ..................                                  [100%]

=================================== FAILURES ===================================
________________ TestLinkEndpoints.test_search_links_short_term ________________
tests/test_api.py:449: in test_search_links_short_term
    assert 'short' in data['error'].lower()
E   AssertionError: assert 'short' in 'search term must be at least 2 characters long'
E    +  where 'search term must be at least 2 characters long' = <built-in method lower of str object at 0x106891590>()
E    +    where <built-in method lower of str object at 0x106891590> = 'Search term must be at least 2 characters long'.lower
________________ TestErrorHandling.test_400_error_missing_body _________________
tests/test_api.py:503: in test_400_error_missing_body
    assert response.status_code == 400
E   assert 500 == 400
E    +  where 500 = <WrapperTestResponse 160 bytes [500 INTERNAL SERVER ERROR]>.status_code
______________ TestErrorService.test_log_error_validation_failure ______________
tests/test_error_logging.py:85: in test_log_error_validation_failure
    ErrorService.log_error(
services/error_service.py:72: in log_error
    raise ValidationError("Method, endpoint, and status_code are required")
E   exceptions.ValidationError: Method, endpoint, and status_code are required
__________________ TestErrorService.test_get_error_statistics __________________
tests/test_error_logging.py:177: in test_get_error_statistics
    assert stats['status_code_counts']['200'] == 2
E   KeyError: '200'
___________________ TestErrorService.test_delete_old_errors ____________________
tests/test_error_logging.py:214: in test_delete_old_errors
    old_error_check = Error.query.get(old_error.id)
/opt/anaconda3/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py:566: in __get__
    return self.impl.get(state, dict_)  # type: ignore[no-any-return]
/opt/anaconda3/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py:1086: in get
    value = self._fire_loader_callables(state, key, passive)
/opt/anaconda3/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py:1116: in _fire_loader_callables
    return state._load_expired(state, passive)
/opt/anaconda3/lib/python3.12/site-packages/sqlalchemy/orm/state.py:798: in _load_expired
    self.manager.expired_attribute_loader(self, toload, passive)
/opt/anaconda3/lib/python3.12/site-packages/sqlalchemy/orm/loading.py:1661: in load_scalar_attributes
    raise orm_exc.ObjectDeletedError(state)
E   sqlalchemy.orm.exc.ObjectDeletedError: Instance '<Error at 0x106a17290>' has been deleted, or its row is otherwise not present.
=========================== short test summary info ============================
FAILED tests/test_api.py::TestLinkEndpoints::test_search_links_short_term - A...
FAILED tests/test_api.py::TestErrorHandling::test_400_error_missing_body - as...
FAILED tests/test_error_logging.py::TestErrorService::test_log_error_validation_failure
FAILED tests/test_error_logging.py::TestErrorService::test_get_error_statistics
FAILED tests/test_error_logging.py::TestErrorService::test_delete_old_errors
================== 5 failed, 69 passed, 147 warnings in 3.85s ==================
